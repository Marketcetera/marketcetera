Please note that I had to change a few things after I created QuickfixRuby.cpp and QuickfixRuby.h using swig. I edited those files directly - need to check if there is a better way to do it...

Changes:

QuickfixRuby.cpp:
-----------------

-- Added these lines at the top: 

#include "stdafx.h"

#ifdef HAVE_RUBY

-- Added these to avoid duplicates with ruby's win32.h (in addition to the couple of undefs already defined by swig:

#ifdef send
# undef send
#endif
#ifdef close
# undef close
#endif
#ifdef connect
# undef connect
#endif
#ifdef setsockopt
# undef setsockopt
#endif
#ifdef bind
# undef bind
#endif
#ifdef listen
# undef listen
#endif
#ifdef accept
# undef accept
#endif

-- Changed original line 

 FIX::DataDictionary *temp5 ;
 
 to 
 
 FIX::DataDictionary *temp5 = 0 ;
  
 -> Not a must just cleans a warning during compilation.
 
 -- Added this line at the end of the file:
 
 #endif //HAVE_RUBY
  
QuickfixRuby.h:
---------------
-- Added at the top of the file:

#ifdef HAVE_RUBY

-- Added at the bottom of the file:

#endif //HAVE_RUBY